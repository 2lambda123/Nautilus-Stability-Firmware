# Nautilus-Stability-Firmware
Dynamic and static stability firmware for the Nautilus search and reconnaissance submarine.

Microcontroller: Arduino Mega 2560 Rev3 (ATmega640)
![WhatsApp Image 2022-10-17 at 19 55 52](https://user-images.githubusercontent.com/76393130/196203458-744a0e9c-0284-4df6-a1c5-2895b40d52b0.jpg)

Unmanned Underwater Search and Analysis Vehicle
THE NAUTILUS



Summary:
Coast Guard, NDRF and other allied search and rescue organizations carry out many underwater search operations which include surface water rescue or deep-water rescue and are also engaged in the search for fatal victims. Because of murky water and limitations, the current SONAR system is less accurate. It becomes difficult for them to carry out search operations in a timely and safe manner. Challenges include less precision and maneuverability, and less visibility in murky waters. Presently the underwater equipment used is based on the SONAR system, which has some disadvantages. The system generates a lot of noise which depends on sound levels generated by SONAR. The acoustic waves used in SONAR are affected by sound velocity variations over depth. This causes the refraction of acoustic energy. Also, we discovered numerous rovers that are now being used to solve the problem, not just by the NDRF but also elsewhere, due to the turbidity of Indian water, rovers that are not particularly efficient and many of the rovers now in use are thruster-based, which uses a lot of power and is not cost-effective as they have to be running continuously to maintain depth and also setting up systems for power supply is very difficult in disastrous areas for these reasons Team Nautica (team ID 14109) of Sahyadri College of Engineering and Management, Mangalore presents “THE NAUTILUS”, an effective unmanned underwater search and analysis vehicle, to address the problem.

Prime objective of the project:

Underwater search and investigations are time sensitive and are often performed in extremely challenging conditions.The underwater rescue operations may pose a threat to the divers entering into the sea.In such cases underwater rovers are used inorder to complete the task.It’s difficult for the divers to work underwater for hours because of which it’s a vital requirement to use an underwater rover in the harsh environment.

The main motive to design a rover is for it to detect the fatal victims,to inspect ship’s hulls,to perform gas and oil pipeline’s inspection as well as inspection of underwater internet cables, for surveillance, to monitor underwater welding operation.

Inorder to tackle such problems we team NAUTICA came up with an innovative solution of fully equipped rover which is embedded with the necessary technology, is able to inspect the aquatic environment in an effective, safe, and timely manner with high precision and maneuverability.Adding on to the requirement, an effective method of data collection has been achieved in our system which makes NAUTILUS a fully fledged underwater vehicle.



Risk Management:
 
The nautilus is an effective unmanned underwater rover used for search and analysis and is deployed in disastrous areas when required. The rover is first connected to a power source and deployed from the surface station . Now water starts to enter into the ballast tank resulting in slow descent  of the rover underwater . After the rover reaches the required destination , the search and analysis of the disastrous region begins . All the controls will be managed from the surface station and data will be transferred through the LAN cable . The ballast tank provides stabilization in uneven currents and also the thrusters revolve to provide optimum motion . The rover begins necessary data collection with the help of Intel Realsense D435 and Flir one pro and sends that data to the main surface station where the data is analyzed and the area is deemed fit for human travel . The rover after the search and analysis expels water from the ballast tank and starts to resurface back to the surface station . Most of the data processing and collection will be analyzed in the surface station.

Aims and Objectives:

The objectives that we are trying to achieve are:
It should be able to carry out underwater inspections in an effective, safe, and timely manner with high precision and maneuverability, 
Should provide better visibility in murky waters 
With the help of high quality sensors and intelligent software to capture high definition images for Data analytics
With the help of thermal cameras and thermal imaging we should be able to distinguish between the various materials at sub sea level.
Depth camera for providing 3D mapping of subsea structures, helps for effective analysis, search and rescue.
To understand the Nature of the wreck.
Construction of a real-time 3D model of the wreck
Cameras for Navigation and obstacle detection. 
Helps in Mobility and control.
Rover is more power efficient which increases the operating time.
Would help the NDRF team to perform a fast and secure rescue, recovery and survey operations.




Expected Outcomes:

To tackle the issues of power consumption our rover is equipped with four ballast tanks, of which two of them are central tanks used for the purpose of surface and descent. Two thrusters in the rover help in mobility and control. The external ballast tanks aid in the stabilization. They are operated with the help of pumps, solenoid valves, MPU6050 gyro and water to reduce the number of thrusters and make the rover more power efficient which increases the operating time. Since our rover is a prototype as of now we are expecting the rover to go to a depth of around 10 meters. The rover is equipped with fins at the rear, which improves dynamic pitch stability and reduces angular velocity due to cross currents in the rivers or sea and static pitch stability is done by the pilot itself by rotating the thruster with the help of stepper motors by an angle. Under operation, the surface station launches the rover, then submerges towards the wreck, collects the data, sends its back to the surface station and then resurfaces. The data is collected with a set of three cameras, that is depth, thermal and 4K camera. Combining all the data with the help of the software we can construct a real-time 3D model of the wreck, provide and map thermal images, and also use these cameras for navigation and obstacle detection. The data obtained can be used to provide a safe environment for the rescue personnel. 

Sturdy and reliable structure of the rover:
The rover will be used in disaster prone areas so the main structure should be able to handle small amounts of impact and should be lightweight for good maneuverability  . This problem is tackled by favoring the use of high specific strength composite materials. The main three structural elements of the rover use composite materials like pvc , acrylic and teflon .Pvc is commonly known to be very strong and reliable material even providing properties like neutral buoyancy which is helpful in marine usage .teflon has very high corrosion resistance, self-lubrication and high temperature resistance.  It even provides a very good seal and is easily machinable.


Power efficient rover:
In disastrous areas power supply is really scarce so a power efficient rover is a basic necessity .Most of the rovers nowadays use thrusters to sink and resurface but require the thrusters to be continuously running which results in high power consumption which is not ideal in disastrous areas . Our rover uses ballast tank technology which only requires power for the pump and compressor for resurfacing purposes . This drastically reduces the power consumption and provides very good stabilization for the rover.

Data analysis and 3d construction :



Technology stack :





                                             Figure 1: Simple architecture of our system

With the help of open computer vision we will be collecting images and also estimating the depth of the objects at any point within the desired range.
Deep Learning techniques will be used after collecting the data that will allow us to extract the features and analyze the collected data.
In the context of rapid advances of RGB-D cameras that combine both visual and 3D shape information. We will  focus on Object detection, classification of objects and 3d reconstruction of the objects from the collected data.
Object detection is a computer vision technique that allows us to identify and locate objects in the desired environment.
For training a model on the collected data we will be using tensorflow.This will allow us to track the precise location of the objects. 
3D construction will help understand the complex things that will be encountered in the data. The tool used will be Alice Meshroom for the 3D reconstruction.
Arduino Mega is used to control the thrusters, stepper motors, ballast tank pumps, solenoid valve and lights through the relay, motor driver and ESC’s
Propulsion Maneuvering is done through Arduino Mega and the data is acquired through Jetson Nano.



 Figure 2: Standard Operating Procedure
Thrusters:
The two thrusters used is the “T200 Thruster “ by blue robotics lnc .The T200 is basically a brushless electric motor, just like you’d find on an RC airplane or a quadcopter drone. The big difference is that this motor is purpose-built for use in the ocean and was designed specifically for use on ROVs, AUVs, and robotic surface vehicles. 

The T200 is made of high-strength, UV-resistant polycarbonate injection molded plastic. The core of the motor is sealed and protected with an epoxy coating and it uses high-performance plastic bearings in place of steel bearings that rust in saltwater.

A specially designed propeller and nozzle provide efficient, powerful thrust while active water-cooling keeps the motor cool and can handle extreme pressures.

Intel Realsense D435:
The Intel RealSense depth camera D435 is a stereo solution, offering quality depth for a variety of applications. Its wide field of view is perfect for applications such as robotics. In the case of our rover, the depth camera helps produce three-dimensional scans of a particular area during surveillance. The 3D models further help in carrying out detailed inspections.11

FLIR one pro :

Flir one pro is a Pro-Grade Thermal Camera, it has around 19,200-pixel resolution. This thermal camera in the use case of our rover helps in providing accurate thermal imaging thus helping to differentiate objects in the marine environment. All objects emit infrared radiation, known as a heat signature. The Flir one pro detects and measures the infrared radiation of objects. The camera converts this data into an electronic image that shows the apparent temperature of the object being measured.

Stepper motors:

The chosen stepper motor moves in precisely repeatable steps, hence they are the motors of choice for machines requiring precise position control. The thrusters are mounted onto the stepper motors by the means of specially designed clamps and help in the bidirectional rotation of the thrusters which helps in pitch stability.

 Bilge pump: 

Bilge submersible Pump outfitted with a rare earth strong magnetic motor, with pure copper coils that can withstand high temperatures. This bilge pump helps in precisely emptying water from the ballast tanks so that the entire rover resurfaces to the surface. This pump is completely submersible and an ideal pump for marine use. They are operated by the means of switches.

Solenoid valve:

The valve works with the solenoid coil which operates electronically with DC 12 volt supply. As it is a normally closed assembly, it opens the flow of fluids as soon as it is powered ON and stops/blocks the flow when the supply voltage is removed. This valve helps in letting water when actuated. The valve is being used in the ballast tanks for the inlet to take in water for submerging and taking in air while resurfacing. They are operated by the means of switches.

Arduino mega:

 Aurdino Mega is a microcontroller based on the ATmega2560. It includes 54 digital input/output pins, including 16 analog input pins, 14 PWM output, and 4 hardware serial ports (UARTs). It operates on a 16 MHz clock signal. Also, it includes an ICSP header, a power jack, a USB connection, as well as an RST button. Arduino mega works as the brain of the rover control system and helps in actuating many of the necessary components and keeps the rover Dynamically stable. This is used to control the thrusters, stepper motors, and lights. 


Jetson nano: 

The Jetson Nano is a small, powerful computer designed to power entry-level edge AI applications and devices. which includes accelerated libraries for deep learning, computer vision, graphics, multimedia, and more.It has cuda parallel processing with cuda, developers are able to dramatically speed up computing applications by harnessing the power of GPUs.


Lumen Subsea Light:

These are pre-connected (daisy-chained) sets of Lumen Subsea Lights, making it easy to install two or four lights with a single penetrator to the watertight enclosure.It is is a blindingly bright LED light for use on ROVs, AUVs, and other subsea applications.The light operates on 10-48V inputs and can accept PWM signals from 3-48V! It is compatible with many common boards like the Arduino, Raspberry Pi, and PixHawk. The case warms up to a comfortable 55°C (131°F) when operated in air and stays much cooler in water.				


Gyroscope MPU6050: 
MPU6050 is a Micro Electro-mechanical system (MEMS), it consists of a three-axis accelerometer and three-axis gyroscope. It helps us to measure velocity, orientation, acceleration, displacement and other motion-like features. It has a 16-bit analog to digital converter hardware. Due to this feature, it captures three-dimension motion at the same time.Its main feature is that it can easily combine with accelerometer and gyro.
Back-up Plan:

We have designed our system in such a way that if one of the thrusters stop working  due to some technical fault then our rover can bring back its stabilization through the ballast tanks by expelling appropriate amount of water and by filling it with compressed air.Also, the resurfacing can be done through this process.If in case the power supply turns off or the Arduino stops working  we have designed a backup plan by giving direct supply to the pump.This can be done only for the emergency cases.Also as alternators are present in the boat , power supply can be provided through that.


System Requirement :

Data Collection
The whole system here is divided into two categories namely the system for data collection and the system for propulsion maneuvering. The maneuvering of thrusters, ballast tank pump, compressor, and servo is done through Arduino Mega for the ballast tank operation. The underwater analysis and Data Collection are mainly done through a Depth camera, Thermal camera, and 4K Camera. For image detection there are two software applications namely Meshroom and TensorFlow. In the meshroom, the images clicked from the depth camera will be processed and a 3D model will be provided. A rough idea of how the object looks can be analyzed through this software and a detailed view from all perspectives and angles can be done in TensorFlow.The system is trained to detect some of the regular objects which are done through a python code. The concept of pipelining in the codes has been adapted for training purposes. In simple words, the output of one process needs to be passed on as the input of another process for the final 3D model.

Control system firmware
For the forward and backward motion of the rover, the motor drivers and ESCs drive the stepper motor and thrusters. The two thrusters mounted beneath will provide the ascent and descent, while the other two will provide the maneuverability in the horizontal plane.The diving and resurfacing are done by a ballast tank with the help of solenoid valves and relays. The solenoid valves act as an inlet for water intake and the pump is used for outtake. For the rover to sink the water has to be allowed into the tanks and for it to float the water has to go out which is done through the pump and then replaced by air might be with the help of air compressors depending on the depth since the water to be expelled inside should have greater pressure compared to the water outside the ballast tank. As our Rover consists of four ballast tanks operated by four relays in the system.

The stabilization of the rover is maintained with the help of thrusters and ballast tanks. The dynamic stability of the rover is maintained with the help of four ballast tanks. Diving and resurfacing of the rover is done by all four tanks, but when it comes to stabilization, it is done with the help of two side tanks with the help of Gyro, Relay modules,  solenoid valves, pumps and air compressors. Whenever the dynamic stability is tampered the gyro does the stabilization by sending the signals to the relay module which in turn triggers the solenoid valves, pumps, and air compressors to act accordingly and stabilize the rover by expelling and taking in the water in needed proportions.

The control system is powered by the 24V 42amps power supply through the ethernet cable.The rover is connected to a ship by series of cables. These cables transmit command and control signals between the operator and the Rover, allowing remote navigation of the vehicle


SOFTWARE:

MESHROOM

Meshroom is a free, open-source 3D Reconstruction Software based on the AliceVision framework.It is a tool that can reconstruct 3D models of objects in photographs. Once you import the photo, you will get a 3D CGI object.It basically gives High Quality 3D models and uses GPUs to combine high quality with performance.As per our needs we can customize some steps as it is an open source nodal workflow.The data and images collected from the Intel Realsense D435 camera can be analyzed and rendered in this Software.


TENSORFLOW

TensorFlow is an open-source library developed by Google primarily for deep learning applications. It also supports traditional machine learning. TensorFlow accepts data in the form of multi-dimensional arrays of higher dimensions called tensors.It uses Python for a convenient front-end API for building applications within the framework, and then executes those applications in high performance C++.Some of the important steps that can be performed in tensorflow are:
Object Detection and Classification
Augmenting output using Depth data
Deploying TensorFlow model using OpenCV
Training on Depth data


 
Financial Breakdown:
Components
Quantity
Amount per piece
Total amount
Processor(Jetson nano)
1
35999
35999
Depth camera( Intel Realsense D435)
1
26000
26000
Thermal camera(Flir one pro)
1
56345
56345
Motor(Stepper motor)
4
423.73
1694.92
Arduino mega
1
1100
1100
Gyroscope
1
200
200
ESC  power distribution board
1
120
120
4” PVC pipe
4
62.25
249.16
4” PVC end cap
8
57.78
462.24
Bilge pump
4
1000
4000
DC 12V Solenoid valve
4
800
3200
24V 4-Channel relay module
1
249
249
Polypropylene block
2
1770
3540
Ethernet Module
1
381.36
381.36
Potentiometer
2
12.71
25.42
The frame (acrylic sheet 4x4x3)
2
1500
3000
miscellaneous
-
-
3345.89
Total
-
-
1,39,911.99







Software requirement

Ground station setup
-
1,00,000
1,00,000
Application development
-
45,000
45,000
Total




1,45,000


CONCLUSION
Rover in aquatic environment need to handle flexible structures,demanding environments with currents and large waves, and changing geometry in undetermined pattern.Building such Rover with no prior knowledge was challenging but was probably for far more creativity and ingenuity.The team worked on every aspect of the system so that it could easily interface and synergize with each other creating a well performing, tuned machine. Several tests were undertaken to develop a fully fledged working prototype.
 
 
 
 
 
 
 
 
